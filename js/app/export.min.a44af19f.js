define(function(e,t,n){t.init=function(t){e(["jquery","xlsx","file-saverjs","sweetalert2"],function(e,t,n,o){var r=e("table.table-report");e(".btn-export").on("click",function(n){if(o.showLoading(),r.length>1){var i=e(r).clone(),a=(new Array).concat([[e(".print-header h5").length?e(".print-header h5").html():e("h5.report-title").html()]]);e.each(i,function(n,o){c=t.utils.sheet_to_json(t.utils.table_to_sheet(o),{header:1,raw:!1}),console.log(c),a=a.concat([""]).concat([[e(o).attr("title")]]).concat(c)});var l=t.utils.json_to_sheet(a,{skipHeader:!0}),s=t.utils.book_new();t.utils.book_append_sheet(s,l,"worksheet"),t.writeFile(s,"EREG.xlsx")}else{var c=e(r[0]).clone(),p=(c.find("thead").prepend(e("<tr/>")).prepend(e("<tr/>")),t.utils.table_to_book(c[0],{raw:!0,type:"string"})),h=(t.utils.sheet_add_aoa(p.Sheets.Sheet1,[[e(".report-title").html()]],{origin:"A1"}),t.utils.sheet_add_aoa(p.Sheets.Sheet1,[[null]],{origin:-1}),t.utils.sheet_add_aoa(p.Sheets.Sheet1,[[e(".print-footer").html()]],{origin:-1}),t.write(p,{bookType:"xlsx",bookSST:!0,type:"binary"}));window.saveAs(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o<e.length;o++)n[o]=255&e.charCodeAt(o);return t}(h)],{type:"application/octet-stream"}),"EREG.xlsx")}o.close()})}),e(["jquery"],function(e){window.onbeforeprint=function(t){e("table[data-print-split=true]").length>0&&e("table[data-print-split=true]").each(function(t,n){var o=0;e(n).find("[data-print-page]").each(function(t,n){var r=e(n).data("print-page");o=r>o?r:o});var r=0;for(i=1;i<=o;i++){var a=0;e(n).find("[data-print-page="+i+"]").each(function(t,n){a+=e(n).outerWidth()});var l=e("<div />",{class:"table-clone-wrapper"}).css({width:a+10+"px",height:e(n).outerHeight()+15+"px"});e(n).clone().data("print-split","false").css({position:"absolute",left:0==r?r:10-r}).appendTo(l),r+=a,e(n).before(l)}})},window.onafterprint=function(){e(".table-clone-wrapper").remove()}}),e(["jquery","sweetalert2"],function(e,t){e(".btn-export-backend").on("click",function(n){t.showLoading(),e.ajax({url:window.location.href,type:"POST",cache:!1,xhrFields:{responseType:"blob"},success:function(e){window.saveAs(e),t.close()}}).fail(function(){t.fire({title:"Error",text:"Error exporting Excel",icon:"error"})})})})}});

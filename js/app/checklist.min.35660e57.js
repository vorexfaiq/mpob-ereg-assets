define(function(e,t,n){t.init=function(t){var n,a={},o={};e(["checklist.module.datatables","checklist.module.datatables.query","checklist.module.datatables.check","checklist.module.datatables.action","checklist.module.datatables.sort"],function(e,r,i,c,s){$(".filter-form").find("select,:input:not(button):not([type=radio]):not([type=checkbox]),input[type=radio]:checked,input[type=checkbox]:checked").each(function(e,t){a[$(t).attr("name")]=$(t).val()}),n=e.datatables(t,a,o),query=r.query(n,a,o),check=i.check(n,o),popup=c.open(n,o),add=c.add(n),edit=c.edit(n),verify=c.verify(n,o),submit=c.submit(n,o),submits=c.submitMultiple(n,o),remove=c.remove(n,o),del=c.delete(n,o),delPDF=c.deletePDF(n,o),instruct=c.instruct(),multiple=c.multiple(n),fetchBNM=c.fetchBNM(n),$(n.header()).find(" > tr > .sort ").length&&(sort=s.sort(n))})}}),define("checklist.module.datatables.columnDefs",function(){return function(e){return[{targets:2,className:"nowrap"}]}}),define("checklist.module.datatables.columns",["mustache"],function(e){return function(e,t){return $.map(e,function(e){return $(e).data("checkbox")?{data:$(e).data("column"),render:function(e,n,a){return'<div class="checkbox check-info"><input type="checkbox" id="check-'+e+'" class="select-checklist" value="'+e+'" '+(e in t?'checked="checked"':"")+" "+("verify_status"in a&&1==a.verify_status?"disabled":"")+'><label for="check-'+e+'"></label></div>'},className:"small-cell"}:$(e).data("sort")?{data:$(e).data("column"),render:function(e,t,n){return'<i class="fa fa-2x fa-angle-double-up sort-top" aria-hidden="true" data-id="'+e+'" data-direction="top"></i><i class="fa fa-2x fa-angle-up sort-up" aria-hidden="true" data-id="'+e+'" data-direction="up"></i><i class="fa fa-2x fa-angle-down sort-down" aria-hidden="true" data-id="'+e+'" data-direction="down"></i><i class="fa fa-2x fa-angle-double-down sort-bottom" aria-hidden="true" data-id="'+e+'" data-direction="bottom"></i>'},className:"sort small-cell"}:{data:$(e).data("column"),defaultContent:""}})}}),define("checklist.module.datatables.query",function(){return{query:function(e,t,n){$(".btn.btn-query").on("click",function(a){a.preventDefault(),Object.keys(n).forEach(function(e){delete n[e]}),$(e.containers()).find("i.select-all").data("state","unchecked").removeClass("fa-check-square-o").addClass("fa-square-o");var o=$("input[data-btn]:checked").data("btn");"verify"==o&&($(".btn-verify").attr("data-selected","").prop("disabled",!0).show(),$(".btn-unverify").attr("data-selected","").prop("disabled",!0).hide(),$(".btn-reverify").hide()),"unverify"==o&&($(".btn-verify").attr("data-selected","").prop("disabled",!0).hide(),$(".btn-unverify").attr("data-selected","").prop("disabled",!0).show(),$(".btn-reverify").show()),$(".filter-form").find("select,:input:not(button):not([type=radio]):not([type=checkbox]),input[type=radio]:checked,input[type=checkbox]:checked").each(function(e,n){t[$(n).attr("name")]=$(n).val()}),e.draw()})}}}),define("checklist.module.datatables.check",function(){return{check:function(e,t){e.on("change","input[type=checkbox]",function(e){$status=$(e.currentTarget).closest("tr").find(".select-status").val(),$(e.currentTarget).is(":checked")?t[$(e.currentTarget).val()]=$status:delete t[$(e.currentTarget).val()],Object.keys(t).length?$(".btn-verify, .btn-unverify, .btn-submit, .btn-submit-multiple, .btn-drop, .btn-delete, .btn-remove").attr("data-selected",Object.keys(t).length).prop("disabled",!1):$(".btn-verify, .btn-unverify, .btn-submit, .btn-submit-multiple, .btn-drop, .btn-delete, .btn-remove").attr("data-selected","").prop("disabled",!0)}),e.on("change","select",function(e){var t=$(e.currentTarget).closest("tr").find("input[type=checkbox]");t.prop("checked",!1).trigger("change"),t.prop("checked",!0).trigger("change")}),e.on("click","i.select-all",function(t){var n=$(t.currentTarget).data("state");$(e.containers()).find(".select-checklist:enabled").each(function(e,t){$(t).prop("checked","unchecked"==n).trigger("change")}),$(t.currentTarget).data("state","unchecked"==n?"checked":"unchecked").removeClass("fa-square-o fa-check-square-o").addClass("unchecked"==n?"fa-check-square-o":"fa-square-o")})}}}),define("checklist.module.datatables.action",["sweetalert2"],function(e){return{open:function(e,t){var n=[];$(".btn-open").on("click",function(e){$.each(t,function(e,t){var a=window.open("/contract-management/contracts/"+e,"_blank");n.push(a),a.onunload=function(){n.pop(a)}})}),$(".btn-close").on("click",function(e){$.each(n,function(e,t){t.close()})})},add:function(e){$(document).on("click",".btn-bar button.btn-add",function(t){t.preventDefault(),require(["sweetalert2","mustache","select2","cache","moment"],function(n,a,o,r,i){var c=$(t.target).find("script").html();n.fire({title:$(t.target).data("title")?$(t.target).data("title"):"Add New",html:a.render(c),confirmButtonText:"Add",showCancelButton:!0,focusConfirm:!1,allowOutsideClick:function(){return!n.isLoading()},preConfirm:function(){var a=$(n.getContent()),o=$(t.target).data("input").split(","),r={};return $.each(o,function(e,t){if(a.find("[name="+t+"]").prop("required")&&""==a.find("[name="+t+"]").val()){var o=a.find("[name="+t+"]").siblings("label").clone().children().remove().end().text();return n.showValidationMessage(o+" is required")}inputform=a.find("[name="+t+"]"),inputform.is(":radio")||inputform.is(":checkbox")?r[t]=a.find("[name="+t+"]:checked").val():r[t]=a.find("[name="+t+"]").val()}),n.showLoading(),$.post(window.location.href,r).then(function(t){if(1==t.success)return e.ajax.reload(null,!1),t}).catch(function(e){if(null===e.responseJSON)return n.showValidationMessage("Error: Unable to add.");var t=e.responseJSON.errors;void 0!==t[Object.keys(t)[0]][0]?n.showValidationMessage(t[Object.keys(t)[0]][0]):n.showValidationMessage("Error: Unable to add.")})},onOpen:function(e){$(e).find("input.datepicker").daterangepicker({singleDatePicker:!0,showDropdowns:!0,minYear:1990,locale:{format:"DD/MM/YYYY"}}),r("currency","/filter/currencies").done(function(t){var n=$(e).find("#select-currency").select2({data:$.map(t,function(e){return e.id=e.id||e.code,e.text=e.code+" - "+e.description,e}),dropdownAutoWidth:!0,escapeMarkup:function(e){return e},templateResult:function(e){return e.loading?e.text:'<div><span class="short_description">'+e.code+'</span> - <span class="description">'+e.description+"</span></div>"},templateSelection:function(e){return e.code?e.code:e.text}});$(n).val($(n).data("value")).trigger("change")}),r("superroles","/filter/superroles").done(function(t){var n=$(e).find(".select-role").select2({placeholder:"Please select",dropdownAutoWidth:!0,minimumResultsForSearch:-1,escapeMarkup:function(e){return e},templateResult:function(e){return e.loading?e.text:'<div><span class="description">'+e.text+"</span></div>"},templateSelection:function(e){return e.text},data:t});n.data("value")&&n.val(n.data("value")).trigger("change")});$(e).find("#select-company").select2({placeholder:"TRADE DEVELOPMENT UNIT",ajax:{id:"id",url:"/filter/companies",dataType:"json",delay:250,data:function(e){return{search:e.term,page:e.page||1}},processResults:function(e,t){return t.page=t.page||1,{results:e.data,pagination:{more:50*t.page<e.total}}},cache:!1},minimumInputLength:3,dropdownAutoWidth:!0,escapeMarkup:function(e){return e},templateResult:function(e){return e.loading?e.text:'<div><span class="license-no">'+(null!==e.last_license_no?e.last_license_no.license_no:"")+'</span> - <span class="name">'+e.company_name+"</span></div>"},templateSelection:function(e){return e.last_license_no?e.last_license_no.license_no+" - "+e.company_name:e.text}}).on("select2:open",function(e){$("span.select2-reset").remove(),$("<span />",{class:"select2-reset",click:function(){$(e.currentTarget).val(null).trigger("change").select2("close")}}).html("TRADE DEVELOPMENT UNIT").prependTo(".select2-dropdown")})}}).then(function(e){e.value&&n.fire({title:"Success",html:void 0!==e.value.message?e.value.message:"Data has been added",icon:"success",position:"top-end",showConfirmButton:!1,timer:3e3})})})})},edit:function(e){$(document).off("click",".content a.quick-edit"),$(document).on("click",".content a.quick-edit",function(t){t.preventDefault(),require(["sweetalert2","mustache","select2","cache","moment"],function(n,a,o,r,i){var c=$("<div />");c.load($(t.target).attr("href"),function(a){n.fire({html:a,confirmButtonText:"Update",showCancelButton:!0,focusConfirm:!1,allowOutsideClick:function(){return!n.isLoading()},preConfirm:function(){var a=$(n.getContent()),o=c.find(".form-popup").data("input").split(","),r={};return $.each(o,function(e,t){if(a.find("[name="+t+"]").prop("required")&&""==a.find("[name="+t+"]").val()){var o=a.find("[name="+t+"]").siblings("label").clone().children().remove().end().text();return n.showValidationMessage(o+" is required")}inputform=a.find("[name="+t+"]"),inputform.is(":radio")||inputform.is(":checkbox")?r[t]=a.find("[name="+t+"]:checked").val():r[t]=a.find("[name="+t+"]").val()}),n.showLoading(),$.ajax({url:$(t.target).attr("href"),type:"PUT",data:r,success:function(t){if(1==t.success)return e.ajax.reload(null,!1),t}}).catch(function(e){if(null===e.responseJSON)return n.showValidationMessage("Error: Unable to update.");var t=e.responseJSON.errors;void 0!==t&&void 0!==t[Object.keys(t)[0]][0]?n.showValidationMessage(t[Object.keys(t)[0]][0]):n.showValidationMessage("Error: Unable to update.")})},onOpen:function(e){$(e).find("input.datepicker").daterangepicker({singleDatePicker:!0,showDropdowns:!0,minYear:1990,locale:{format:"DD/MM/YYYY"}}),r("currency","/filter/currencies").done(function(t){var n=$(e).find("#select-currency").select2({data:$.map(t,function(e){return e.id=e.id||e.code,e.text=e.code+" - "+e.description,e}),dropdownAutoWidth:!0,escapeMarkup:function(e){return e},templateResult:function(e){return e.loading?e.text:'<div><span class="short_description">'+e.code+'</span> - <span class="description">'+e.description+"</span></div>"},templateSelection:function(e){return e.code?e.code:e.text}});$(n).val($(n).data("value")).trigger("change")}),r("superroles","/filter/superroles").done(function(t){var n=$(e).find(".select-role").select2({placeholder:"Please select",dropdownAutoWidth:!0,minimumResultsForSearch:-1,escapeMarkup:function(e){return e},templateResult:function(e){return e.loading?e.text:'<div><span class="description">'+e.text+"</span></div>"},templateSelection:function(e){return e.text},data:t});n.data("value")&&n.val(n.data("value")).trigger("change")});$(e).find("#select-company").select2({placeholder:"TRADE DEVELOPMENT UNIT",ajax:{id:"id",url:"/filter/companies",dataType:"json",delay:250,data:function(e){return{search:e.term,page:e.page||1}},processResults:function(e,t){return t.page=t.page||1,{results:e.data,pagination:{more:50*t.page<e.total}}},cache:!1},minimumInputLength:3,dropdownAutoWidth:!0,escapeMarkup:function(e){return e},templateResult:function(e){return e.loading?e.text:'<div><span class="license-no">'+(null!==e.last_license_no?e.last_license_no.license_no:"")+'</span> - <span class="name">'+e.company_name+"</span></div>"},templateSelection:function(e){return e.last_license_no?e.last_license_no.license_no+" - "+e.company_name:e.text}}).on("select2:open",function(e){$("span.select2-reset").remove(),$("<span />",{class:"select2-reset",click:function(){$(e.currentTarget).val(null).trigger("change").select2("close")}}).html("TRADE DEVELOPMENT UNIT").prependTo(".select2-dropdown")})}}).then(function(e){e.value&&n.fire({title:"Success",html:void 0!==e.value.message?e.value.message:"Data has been updated",icon:"success",position:"top-end",showConfirmButton:!1,timer:3e3}),c.remove()})})})})},verify:function(t,n){$(".btn-bar").off("click",".btn-verify, .btn-unverify, .btn-reverify"),$(".btn-bar").on("click",".btn-verify, .btn-unverify, .btn-reverify",function(a){e.showLoading(),$.ajax({url:"contract-management/verifies",method:"POST",data:{contracts:n,action:$(a.currentTarget).data("action")},success:function(o,r,i){t.ajax.reload(null,!1),Object.keys(n).forEach(function(e){delete n[e]}),$(t.containers()).find("i.select-all").data("state","unchecked").removeClass("fa-check-square-o").addClass("fa-square-o"),$(".btn-verify, .btn-unverify, .btn-drop, .btn-delete, .btn-remove").attr("data-selected","").prop("disabled",!0),e.fire({position:"top-end",icon:"success",title:"verify"==$(a.currentTarget).data("action")?"Verified":"Unverified",showConfirmButton:!1,timer:3e3})}})})},submit:function(t,n){$(".btn-bar").on("click",".btn-submit",function(a){e.showLoading(),$.ajax({url:"contract-management/submit",method:"POST",data:{contracts:Object.keys(n)},success:function(a,o,r){t.ajax.reload(null,!1),Object.keys(n).forEach(function(e){delete n[e]}),$(t.containers()).find("i.select-all").data("state","unchecked").removeClass("fa-check-square-o").addClass("fa-square-o"),$(".btn-drop, .btn-delete, .btn-remove, .btn-submit").attr("data-selected","").prop("disabled",!0),e.fire({position:"top-end",icon:0==a.success?"error":"success",title:0==a.success?"Error":"Success",text:a.message,showConfirmButton:!1,timer:3e3})}})})},submitMultiple:function(t,n){$(".btn-bar").on("click",".btn-submit-multiple",function(a){e.showLoading(),$.ajax({url:"contract-management/multiple-submit",method:"POST",data:{contracts:Object.keys(n)},success:function(a,o,r){t.ajax.reload(null,!1),Object.keys(n).forEach(function(e){delete n[e]}),$(t.containers()).find("i.select-all").data("state","unchecked").removeClass("fa-check-square-o").addClass("fa-square-o"),$(".btn-drop, .btn-delete, .btn-remove, .btn-submit").attr("data-selected","").prop("disabled",!0),e.fire({position:"top-end",icon:0==a.success?"error":"success",title:0==a.success?"Error":"Success",text:a.message,showConfirmButton:!1,timer:3e3})}})})},remove:function(t,n){$(".btn-bar").on("click",".btn-remove",function(a){a.preventDefault(),e.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#333",confirmButtonText:"Yes, remove it!",allowOutsideClick:function(){return!e.isLoading()}}).then(function(a){if(a.value){e.showLoading();var o=[];$.each(n,function(e,t){o.push(e)}),$.ajax({url:location.href+"?del="+encodeURI(JSON.stringify(o)),type:"DELETE",data:{items:n},success:function(a){t.ajax.reload(null,!1),Object.keys(n).forEach(function(e){delete n[e]}),e.fire({title:"Removed!",text:"User(s) has been removed.",icon:"success",timer:3e3,position:"top-end",showConfirmButton:!1}).then(function(e){$(t.containers()).find("i.select-all").data("state","unchecked").removeClass("fa-check-square-o").addClass("fa-square-o"),$(".btn-verify, .btn-unverify, .btn-open, .btn-delete, .btn-remove").attr("data-selected","").prop("disabled",!0)})}})}})})},delete:function(t,n){$(".btn-bar").on("click",".btn-delete",function(a){a.preventDefault(),e.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#333",confirmButtonText:"Yes, remove it!",allowOutsideClick:function(){return!e.isLoading()}}).then(function(a){if(a.value){e.showLoading();var o=[];$.each(n,function(e,t){o.push(e)}),$.ajax({url:location.href+"?del="+encodeURI(JSON.stringify(o)),type:"DELETE",data:{items:n},success:function(a){t.ajax.reload(null,!1),Object.keys(n).forEach(function(e){delete n[e]}),e.fire({title:"Deleted!",text:""==a?"Item has been deleted.":a.message,icon:""==a?"success":0==a.success?"error":"success",timer:3e3,position:"top-end",showConfirmButton:!1}).then(function(){$(t.containers()).find("i.select-all").data("state","unchecked").removeClass("fa-check-square-o").addClass("fa-square-o"),$(".btn-verify, .btn-unverify, .btn-open, .btn-delete, .btn-remove").attr("data-selected","").prop("disabled",!0)})}})}})})},deletePDF:function(t,n){$("body").on("click",".btn-delete-pdf",function(t){t.preventDefault(),console.log($(t.target),$(t.target).data("id")),e.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#333",confirmButtonText:"Yes, remove it!",allowOutsideClick:function(){return!e.isLoading()}}).then(function(n){n.value&&(e.showLoading(),$.ajax({url:location.href+"/"+$(t.target).data("id")+"/pdf",type:"DELETE",success:function(n){e.fire({title:"Deleted!",text:""==n?"Item has been deleted.":n.message,icon:""==n?"success":0==n.success?"error":"success",timer:3e3,position:"top-end",showConfirmButton:!1}).then(function(){$("span .open-pdf[data-contract-id="+$(t.target).data("id")+"]").closest("span").css("color","#aaa")})}}))})})},instruct:function(){$(".filter-form").on("click",".btn-instruct",function(e){require(["sweetalert2","mustache"],function(t,n){t.fire({title:"Multiple Contract Instruction",html:n.render($(e.target).find("#instruction-tpl").html()),icon:"info",showClass:{icon:"swal2-icon-show small"}})})})},multiple:function(e){require(["sweetalert2","papaparse","moment","validate","jszip"],function(t,n,a,o,r){o.validators.date=function(e){return a(e,"DD/MM/YYYY",!0).isValid()?null:"contains invalid date: "+e+". Please use DD/MM/YYYY format."},$(".btn-bar").on("change","#multiple-contract",function(n){t.showLoading();var i=new Array,c=new Array;$(n.currentTarget).parse({config:{encoding:"text/plain"==$(n.currentTarget)[0].files[0].type?"windows-1252":null,delimiter:"text/plain"==$(n.currentTarget)[0].files[0].type?"þ":",",skipEmptyLines:!0,beforeFirstChunk:function(e){if("text/plain"!=$(n.currentTarget)[0].files[0].type){var t=e.split(/\r\n|\r|\n/);return t.splice(0,1),t.join("\n")}return e},step:function(e,n){var r=e.data[0];if(20!==r.length)return n.abort(),void t.fire({icon:"error",title:"Warning",text:"Invalid file format or file corrupted. Please refer Instruction."});var s=r[8].trim(),l={contract_date:r[0].trim(),contract_type:r[1].trim(),product:r[2].trim(),packaging:r[3].trim(),buyer_name:r[4].trim(),buyer_licno:r[5].trim(),seller_name:r[6].trim(),seller_licno:r[7].trim(),contract_no:r[8].trim(),quantity:r[9].trim(),currency:r[10].trim(),price:r[11].trim(),price_basis:r[12].trim(),price_fob:r[13].trim(),delivery_month:r[14].trim(),delivery_year:r[15].trim(),delivery_location:r[16].trim(),port_loading:r[17].trim(),port_discharge:r[18].trim(),remark:r[19].trim()},u=o(l,{contract_date:{presence:!0,date:!0}},{format:"flat"});if(u)return i.push({contract_no:s,error:u}),t.fire({icon:"error",title:"Warning",text:u}),n.abort();l.contract_date=a(r[0].trim(),"DD/MM/YYYY").format("YYYY-MM-DD"),c.push(l)},error:function(e,n,a,o){t.fire({icon:"error",title:"Warning",text:o})},complete:function(a,o){if(0===i.length&&($.isEmptyObject(a.meta)||0==a.meta.aborted)){var s=new r;s.file($(n.currentTarget).data("token"),JSON.stringify(c));s.generateAsync({type:"blob",compression:"DEFLATE"}).then(function(a){var o=new File([a],"multiple_contract"),r=new FormData;r.append("multiple_contract",o),$(n.currentTarget).val(""),$.ajax({data:r,url:"/contract-management/multiple",type:"POST",processData:!1,contentType:!1,dataType:"json",success:function(a){1==a.success&&(e.ajax.reload(null,!1),t.fire({icon:"info",title:"File uploaded",text:"Please review any error before submit your contracts."}),$(n.currentTarget).data("token",a.token))},error:function(e,n,a){"419"==e.status?t.fire({icon:"error",title:"Error",text:"Token mismatch. Please refresh and re-upload file.",onClose:function(){window.location.reload()}}):"422"==e.status?t.fire({icon:"error",title:"Error",text:"Error parsing file. File is empty or corrupted."}):t.fire({icon:"error",title:"Error",text:"Upload failed. An error has been occured."})}})})}}}})})})},fetchBNM:function(e){require(["sweetalert2","mustache","select2","cache","moment"],function(t,n,a,o,r){$(".btn-bar").on("click",".btn-bnm",function(a){var i=$(".btn-bar").find("#fetch-bnm-form").html();t.fire({title:"Fetch currency rate from BNM",html:n.render(i),confirmButtonText:"Fetch",showCancelButton:!0,focusConfirm:!1,allowOutsideClick:function(){return!t.isLoading()},preConfirm:function(){var n=t.getContent(),a=$(n).find("input[name=currency_date]").val(),o=$(n).find("#select-currency").val();return r(a,"DD/MM/YYYY",!0).isValid()?""==o?t.showValidationMessage("Invalid Currency"):(t.showLoading(),$.post("/common-services/fetch-bnm",{date:a,currency:o}).then(function(t){if(1==t.success)return e.ajax.reload(null,!1),t}).catch(function(e){t.showValidationMessage("Unable to fetch currency rate.")})):t.showValidationMessage("Invalid Date")},onOpen:function(e){$(e).find("input[name=currency_date]").daterangepicker({singleDatePicker:!0,showDropdowns:!0,minYear:1990,locale:{format:"DD/MM/YYYY"}}),o("currency","/filter/currencies").done(function(t){var n=$(e).find("#select-currency").select2({data:$.map(t,function(e){return e.id=e.id||e.code,e.text=e.code+" - "+e.description,e}),dropdownAutoWidth:!0,escapeMarkup:function(e){return e},templateResult:function(e){return e.loading?e.text:'<div><span class="short_description">'+e.code+'</span> - <span class="description">'+e.description+"</span></div>"},templateSelection:function(e){return e.code?e.code:e.text}});$(n).val($(n).data("value")).trigger("change")})}}).then(function(e){e.value&&t.fire({title:"Success",icon:"success",position:"top-end",showConfirmButton:!1,timer:3e3})})})})}}}),define("checklist.module.datatables.sort",function(){return{sort:function(e){e.on("click","tbody .sort i",function(t){var n=window.location.href.split("?")[0]+"/"+$(t.currentTarget).data("id");$.ajax({url:n,type:"POST",data:{direction:$(t.currentTarget).data("direction")},success:function(t){e.draw()}})})}}}),define("checklist.module.datatables.pdf",["sweetalert2","mustache","pinchzoomer"],function(e,t,n){return function(n){e.showLoading(),$.get("/contract-management/contracts/"+n+"/pdf",function(a){e.showLoading();var o=$("#pdf-tpl").html();1==a.uploaded?($("span .open-pdf[data-contract-id="+n+"]").closest("span").css("color","#1dbb99"),e.fire({showConfirmButton:!1,allowOutsideClick:!1,customClass:"popup-pdf",imageUrl:"data:image/jpg;base64,"+a.file,onBeforeOpen:function(e){$(e).find(".swal2-header").css("position","relative"),$(e).find(".swal2-image").pinchzoomer({allowMouseWheelZoom:!1})},onOpen:function(t){$(t).on("click",".swal2-close-custom",function(t){e.close()})},onClose:function(e){$("body").css("overflow",""),$(e).off("click",".swal2-close-custom")},html:t.render(o,a),width:"70%"})):e.fire({title:"Upload pdf contract",showCancelButton:!0,confirmButtonText:"Upload",showLoaderOnConfirm:!0,closeOnConfirm:!1,input:"file",inputAttributes:{accept:"application/pdf","aria-label":"Upload your pdf contract"},allowOutsideClick:function(){return!e.isLoading()}}).then(function(a){if(a.value){var r=new FormData;r.append("contract_pdf",a.value),$.ajax({method:"POST",url:"/contract-management/contracts/"+n+"/pdf",data:r,cache:!1,processData:!1,contentType:!1,success:function(a){1==a.success&&($("span .open-pdf[data-contract-id="+n+"]").closest("span").css("color","#1dbb99"),e.fire({showConfirmButton:!1,showCloseButton:!0,allowOutsideClick:!1,customClass:"popup-pdf",imageUrl:"data:image/jpg;base64,"+a.file,onBeforeOpen:function(e){$(e).find(".swal2-header").css("position","relative"),$(e).find(".swal2-image").pinchzoomer({allowMouseWheelZoom:!1})},onOpen:function(t){$(t).on("click",".swal2-close-custom",function(t){e.close()})},onClose:function(e){$("body").css("overflow",""),$(e).off("click",".swal2-close-custom")},html:t.render(o,a),width:"70%"}))},error:function(){e({icon:"error",title:"Oops...",text:"Something went wrong!"})}})}})}).fail(function(){e.fire({icon:"error",title:"Error",text:"Unable to open PDF file. File may be corrupted or missing.",showCloseButton:!0})})}}),define("checklist.module.datatables",["datatables","checklist.module.datatables.columns","checklist.module.datatables.columnDefs","checklist.module.datatables.pdf"],function(){return{datatables:function(e,t,n){var a="checklist.module.datatables.",o=e.find("thead tr th"),r=e.position().top;e.on("page.dt",function(){e.on("draw.dt",function(){$(document).scrollTop()>r&&window.scrollTo(0,r)})}).on("preDraw.dt",function(){e.off("click",".open-pdf")}).on("draw.dt",function(){e.on("click",".open-pdf",function(e){require(a+"pdf")($(e.currentTarget).data("contract-id"))})});var i={};return location.search.substring(1).length>0&&(i=$.parseJSON('{"'+decodeURIComponent(location.search.substring(1)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')),e.DataTable({pageLength:25,processing:!0,serverSide:!0,ordering:!1,order:[[1,"asc"]],dom:'rt<"bottom row blur"<"col-md-2 al"l><"col-md-4"i><"col-md-6"p>><"clear">',columns:require(a+"columns")(o,n),columnDefs:require(a+"columnDefs")(o),language:{sLengthMenu:"Show _MENU_",processing:'<div class="dot-falling"></div>'},ajax:{url:location.href,data:function(e){return delete e.columns,delete e.order,delete e.search,i.hasOwnProperty("autoquery")?(delete i.autoquery,e):$.extend(e,t)},error:function(e,t,n){401==e.status&&window.location.reload()}}})}}});

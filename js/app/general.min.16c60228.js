define(function(t,e,n){e.init=function(){$(document).on("focus",".select2-selection.select2-selection--single",function(t){$(this).closest(".select2-container").siblings("select:enabled").select2("open")}),$(document).on("select2:closing","select.select2-hidden-accessible",function(t){$(t.target).data("select2").$selection.one("focus focusin",function(t){t.stopPropagation()})}),$(document).on("click",".btn-bar .btn-lock",function(e){t(["sweetalert2","moment","datepicker"],function(t,e,n){t.fire({title:"Lock Cumulative Price",text:"Your username will be logged.",confirmButtonText:'<i class="fa fa-lock" aria-hidden="true"></i> Lock',showCancelButton:!0,confirmButtonColor:"#d33",focusConfirm:!1,animation:!1,input:"text",icon:"warning",backdrop:"rgba(90, 0, 0, 0.5)",inputValue:e().subtract(1,"months").format("MM/YYYY"),allowOutsideClick:function(){return!t.isLoading()},inputValidator:function(t){return t?e(t,"MM/YYYY",!0).isValid()?void 0:"Invalid Date":"Date is required"},preConfirm:function(e){return t.showLoading(),$.post("/management-reports/lock",{month:e}).then(function(t){if(1==t.success)return t}).catch(function(e){t.showValidationMessage("Unable to lock cumulative price.")})},onOpen:function(t){$(t).find("input.swal2-input").datepicker({format:"mm/yyyy",minViewMode:1,maxViewMode:2,startDate:e().subtract(1,"month").format("MM/YYYY"),endDate:e().format("MM/YYYY")}),$(t).find("input.swal2-input").datepicker("show")}}).then(function(e){e.value&&t.fire({title:"Price Locked",icon:"success",timer:3e3,showConfirmButton:!1})})})}),$(document).on("click","#dropzone-content form [type=submit].btn-delete",function(e){e.preventDefault(),t(["sweetalert2"],function(t){t.fire({title:"Are you sure to delete this?",text:"You won't be able to revert this!",icon:"warning",confirmButtonText:"Yes, delete it!",confirmButtonColor:"#d33",showCancelButton:!0}).then(function(t){if(t.value){var n=$(e.target).closest("form");n.find("input[name=_method]").val("DELETE"),n.submit()}})})}),$(document).on("click",".btn-change-password",function(e){e.preventDefault(),t(["sweetalert2"],function(t){$("<div />").load("/accounts/change-password",function(e){t.fire({title:"Change Password",html:e,confirmButtonText:"Change Password",focusConfirm:!1,showCancelButton:!0,allowOutsideClick:function(){return!t.isLoading()},preConfirm:function(){var e=$(t.getContent());return t.showLoading(),$.post("/accounts/change-password",{current:e.find("input[name=current]").val(),password:e.find("input[name=password]").val(),password_confirmation:e.find("input[name=password_confirmation]").val()}).then(function(t){if(1==t.success)return t}).catch(function(e){var n=e.responseJSON,o=$("<ul />",{class:"error-list"});$.each(n.errors,function(t,e){$("<li />").addClass("ui-menu-item").attr("role","menuitem").text(n.errors[t][0]).appendTo(o)}),t.showValidationMessage(e.responseJSON.message+"<br/>"+o.html())})}}).then(function(e){e.value&&t.fire({title:"Success",text:"Your password has been changed",icon:"success",position:"top-end",showConfirmButton:!1,timer:3e3})})})})}),$("div.popup").length>0&&t(["sweetalert2"],function(t){$("div.popup").hasClass("popup-success")&&t.fire({title:"Success",html:$("div.popup").html(),position:"top-end",timer:3e3,showConfirmButton:!1,icon:"success"}),$("div.popup").hasClass("popup-danger")&&t.fire({title:"Error",html:$("div.popup").html(),position:"top-end",timer:3e3,showConfirmButton:!1,icon:"error"}),$("div.popup").hasClass("popup-info")&&t.fire({title:"Info",html:$("div.popup").html(),icon:"info"}),$("div.popup").hasClass("popup-reminder")&&t.fire({title:"Reminder",html:$("div.popup").html(),icon:"info",showCancelButton:!0,confirmButtonText:"Update Profile",cancelButtonText:"Later"}).then(function(t){t.value&&(location.href="/accounts/profile")})})}});
